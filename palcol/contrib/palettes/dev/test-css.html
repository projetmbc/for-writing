<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Gradient depuis CSS choisi</title>
  <style>
    body {
      height: 100vh;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: sans-serif;
      gap: 20px;
      background: #111;
      color: white;
    }
    #preview {
      width: 80%;
      height: 200px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }
    input {
      padding: 6px 10px;
      border-radius: 6px;
      border: 1px solid #666;
      width: 240px;
    }
    button {
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      background: #4da3ff;
      font-weight: bold;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <div>
    <input id="cssFile" type="text" placeholder="">
    <button id="loadBtn">Charger</button>
  </div>

  <div id="preview">En attente d’un fichier CSS…</div>

  <script>
    document.getElementById("loadBtn").addEventListener("click", async () => {
      const fileName = document.getElementById("cssFile").value.trim();

      // if (!fileName) return;

      fileName = `../css-code/${fileName}.css`;

      alert(fileName);

      try {
        // Charger le contenu du fichier CSS
        const resp = await fetch(fileName);
        if (!resp.ok) throw new Error("Impossible de charger " + fileName);
        const cssText = await resp.text();

        alert(cssText);

        // Extraire les variables --PALETTE-n
        const regex = /--PALETTE-(\\d+)\\s*:\\s*([^;]+);/g;
        const colors = [];
        let m;
        while ((m = regex.exec(cssText))) {
          colors.push(m[2].trim());
        }

        const preview = document.getElementById("preview");
        if (colors.length >= 2) {
          const gradient = `linear-gradient(90deg, ${colors.join(", ")})`;
          preview.style.background = gradient;
          preview.textContent = `${colors.length} couleurs détectées`;
          console.log("Gradient CSS :", gradient);
        } else {
          preview.style.background = "#333";
          preview.textContent = "Pas assez de couleurs trouvées.";
        }
      } catch (err) {
        alert("Erreur: " + err.message);
      }
    });
  </script>
</body>
</html>
