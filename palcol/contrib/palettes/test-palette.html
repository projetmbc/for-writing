<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="UTF-8">

  <title>Dynamic CSS Palette</title>

  <style>
body {
  font-family: sans-serif;
  padding: 1em;
}

#preview {
  width: 100%;
  height: 150px;
  margin-top: 1em;
  border: 1px solid #ccc;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}
  </style>
</head>

<body>
  <h1>Dynamic Palette Test</h1>

  <label>
    CSS filename (no extension):
    <input type        = "text"
           id          = "filename"
           placeholder = "ex: palette">
  </label>

  <div id="preview">Preview</div>

  <script>
async function loadPalette(filename) {
// supprime l'ancien <link> si présent
  let oldLink = document.getElementById("palette-link");

  if (oldLink) {
    oldLink.remove()
  };

 // crée un <link> pour charger le CSS
  const link = document.createElement("link");

  link.id   = "palette-link";
  link.rel  = "stylesheet";
  link.href = `./css-code/${filename}.css`;

  document.head.appendChild(link);

  link.onload = () => {
    root = getComputedStyle(document.documentElement);

// détecte automatiquement toutes les variables
    const colors = [];

    for (let i = 1; i <= 20; i++) {
      const val = root.getPropertyValue(`--PALETTE-${i}`).trim();

      if (!val) break;

      colors.push(val);
    }

    const preview = document.getElementById("preview");

    if (colors.length >= 2) {
      const gradient = `linear-gradient(to right, ${colors.join(", ")})`;

      preview.style.background = gradient;
      preview.textContent = `${colors.length} colors found.`;

    } else {
      preview.style.background = "#eee";
      preview.textContent = "At least 2 colors needed!";
    }
  };
}

// déclenche sur la touche Entrée
document.getElementById("filename").addEventListener(
  "keypress",
  e => {
    if (e.key === "Enter") {
      loadPalette(e.target.value.trim());
    }
  }
);
  </script>
</body>

</html>
